(()=>{var e={669:(e,t,s)=>{s(818).config(),e.exports={mongoDbUrl:process.env.MONGO_DB_URL,logDbUrl:process.env.LOG_DB_URL,tokenSecretKey:process.env.JWT_SECRET,port:process.env.PORT,adminSecretKey:process.env.ADMIN_SECRET_KEY}},6865:(e,t,s)=>{const a=s(6037),{mongoDbUrl:r}=s(669);a.connect(r,{maxPoolSize:4});const i=a.connection;i.on("error",console.error.bind(console,"connection error:")),i.once("open",(()=>{console.log("Databse connected")})),e.exports=i},4475:(e,t,s)=>{const a=s(5124);s(8639);const r=[];r.push(new a.transports.File({filename:"app.log"}));const i=a.createLogger({format:a.format.combine(a.format.timestamp({format:"YYYY-MM-DD HH:mm:ss"}),a.format.printf((e=>`${e.timestamp} [${e.level.toUpperCase()}]: ${e.message} ${e.meta?JSON.stringify(e.meta):""}`))),transports:r,defaultMeta:{service:"user-service"}});e.exports=i},6593:(e,t,s)=>{const a=s(6107),r=s(829),i=s(5486),n=s(3903),d=s(6928),{getCurrentIPAddress:u,generateRandomAlphaNumericID:o}=s(8093),{port:l,tokenSecretKey:c}=s(669),m=s(1935),g=s(5935);e.exports={createAdmin:async(e,t)=>{try{let{name:s,email:r,password:c,mobile:m}=e.body;if(!(s&&r&&c&&m))return t.status(400).send({status:!1,message:"All fields are required"});let{profilePic:g}=e.files;if(!g)return t.status(400).send({status:!1,message:"No profile pic uploaded"});c=await i.hash(c,10);let p=u(),y="/adminImages/",f=n.v4()+"."+g.name.split(".").pop(),I=`http://${p}:${l}${y}`,h=d.join(__dirname,"..","..","adminImages",f);g.mv(h,(e=>{e&&console.log(e)})),picObj={picName:f,picPath:I};let S={adminId:o(26),sessionToken:o(51),name:s,email:r,password:c,mobile:m,profilePic:picObj},_=await a.create(S);return t.status(201).send({status:!0,message:"Admin created",data:_})}catch(e){return t.status(500).send({status:!1,message:e.message})}},adminLogin:async(e,t)=>{try{let{email:s,password:n}=e.body;if(!s||!n)return t.status(400).send({status:!1,message:"Email and password are required"});let d=await a.findOne({email:s});if(!d)return t.status(400).send({status:!1,message:"Bad Reques!!!"});i.compare(n,d.password,(function(e,a){if(e)throw e;!async function(e){if(e){let e={},a=Date.now(),i=Math.floor(a/1e3),n=r.sign({email:d.email,adminId:d._id.toString(),iat:i},c,{expiresIn:"24h"});return e._id=d._id.toString(),e.email=s,e.token=n,t.setHeader("Authorization","Bearer",n),d.sessionToken=o(51),await d.save(),t.status(200).send({status:!0,message:"Successfully login",data:e})}t.status(401).send({status:!1,message:"Login denied"})}(a)}))}catch(e){return t.status(500).send({status:!1,message:e.message})}},getAllBookingsOfUser:async(e,t)=>{try{const{adminId:s,sessionToken:r,userId:i}=e.params;if(!s||!r)return t.status(400).send({status:!1,message:"All fields are required"});let n=await a.findOne({adminId:s,sessionToken:r});if(!n)return t.status(404).send({status:!1,message:"Bad Reques!!!"});if(n.adminId===s&&n.sessionToken===r){if(!await m.findOne({userId:i}))return t.status(404).send({status:!1,message:"User Not Found"});let e=await g.find({userId:i});return t.status(200).send({status:!0,message:"Success",data:e})}return t.status(400).send({status:!1,message:"Session Expired"})}catch(e){return t.status(500).send({status:!1,message:e.message})}},getOneDayBookings:async(e,t)=>{try{const{adminId:s,sessionToken:r}=e.params;if(!s||!r)return t.status(400).send({status:!1,message:"All fields are required"});let i=await a.findOne({adminId:s,sessionToken:r});if(!i)return t.status(404).send({status:!1,message:"Bad Reques!!!"});if(i.adminId===s&&i.sessionToken===r){let s;if(e.params.date)s=e.params.date;else{let e=new Date;const t=e.getFullYear();s=`${t}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`}let a=await g.find({BookingDate:s}),r=0;for(let e of a)r+=e.grand_total;let i={totalBookings:a,oneDayRevenue:r};return t.status(200).send({status:!0,message:"Success",data:i})}return t.status(400).send({status:!1,message:"Session Expired"})}catch(e){return t.status(500).send({status:!1,message:e.message})}},getOneWeekBookings:async(e,t)=>{try{let{adminId:s,sessionToken:r}=e.params;if(!s||!r)return t.status(400).send({status:!1,message:"All fields are required"});let i=await a.findOne({adminId:s,sessionToken:r});if(!i)return t.status(404).send({status:!1,message:"Bad Reques!!!"});if(i.adminId===s&&i.sessionToken===r){let s,a;if(e.params.startDate&&e.params.endDate)s=e.params.startDate,a=e.params.endDate;else{const e=new Date,t=e.getFullYear();a=`${t}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`;const r=new Date(e.getTime()-6048e5),i=r.getFullYear();s=`${i}-${String(r.getMonth()+1).padStart(2,"0")}-${String(r.getDate()).padStart(2,"0")}`}let r=await g.find({BookingDate:{$gte:s,$lte:a}}),i=0;if(r.length)for(let e of r)i+=e.grand_total;let n={oneWeekBookings:r,grandTotal:i};return t.status(200).send({status:!0,message:"Success",data:n})}return t.status(403).send({status:!1,message:"Session Expired"})}catch(e){return t.status(500).send({status:!1,message:e.message})}},getOneMonthBookings:async(e,t)=>{try{const{adminId:s,sessionToken:r,month:i,year:n}=e.params;if(!(s&&r&&i&&n))return t.status(400).send({status:!1,message:"All fields are required"});let d=await a.findOne({adminId:s,sessionToken:r});if(!d)return t.status(404).send({status:!1,message:"Bad Reques!!!"});if(d.adminId===s&&d.sessionToken===r){const e=`${n}-${i}-01`,s=`${n}-${i}-31`,a=await g.find({createdAt:{$gte:e,$lte:s}});let r=0;if(a.length)for(let e of a)r+=e.grand_total;let d={oneMonthBookings:a,oneMonthRevenue:r};return t.status(200).send({status:!0,message:"Success",data:d})}return t.status(400).send({status:!1,message:"Session Expired"})}catch(e){return t.status(500).send({status:!1,message:e.message})}},getOneYearBookings:async(e,t)=>{try{const{adminId:s,sessionToken:r,year:i}=e.params;if(!s||!r||!i)return t.status(400).send({status:!1,message:"All fields are required"});let n=await a.findOne({adminId:s,sessionToken:r});if(!n)return t.status(404).send({status:!1,message:"Bad Reques!!!"});if(n.adminId===s&&n.sessionToken===r){const e=`${i}-01-01`,s=`${i}-12-31`;let a=await g.find({createdAt:{$gte:e,$lte:s}}),r=0;if(a.length)for(let e of a)r+=e.grand_total;let n={oneYearRequests:a,oneYearRevenue:r};return t.status(200).send({status:!0,message:"Success",data:n})}return t.status(400).send({status:!1,message:"Session Expired"})}catch(e){return t.status(500).send({status:!1,message:e.message})}}}},1681:(e,t,s)=>{const{isValidObjectId:a}=s(6037),r=s(5935),i=s(1935),{adminSecretKey:n}=s(669);e.exports={createBooking:async(e,t)=>{try{const{userId:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"User Id is required"});if(!await i.findOne({userId:s}))return t.status(404).send({status:!1,message:"User Not Found"});let{f_name:a,l_name:n,email:d,mobile:u,address:o,apartment:l,city:c,state:m,state_code:g,countryCode:p,countryName:y,post_code:f,productList:I,CGST:h,SGST:S,grand_total:_,BookingDate:k,TimeSlot:b,booking_status:v,totalProduct:w,total:A}=e.body,N=[];for(let e of I){let{name:t,subTitle:s,bookingQty:a,category:r,description:i,discount:n,imgUrl:d,price:u,status:o,stock_items:l,subTotal:c}=e;N.push({name:t,subTitle:s,bookingQty:a,category:r,description:i,discount:n,imgUrl:d,price:u,status:o,stock_items:l,subTotal:c})}let T,P,O,B="AP";do{T=Math.floor(1e5+899999*Math.random()),P=B+T,O=await r.findOne({bookingId:P})}while(O);let x={userId:s,bookingId:P,f_name:a,l_name:n,email:d,mobile:u,address:o,apartment:l,city:c,state:m,state_code:g,countryCode:p,countryName:y,post_code:f,productList:I,CGST:h,SGST:S,grand_total:_,BookingDate:k,TimeSlot:b,booking_status:v,totalProduct:w,total:A},C=await r.create(x);return t.status(200).send({status:!0,message:"Booking created successfully",data:C})}catch(e){return t.status(400).send({status:!1,message:e.message})}},getAllSlotsOfADate:async(e,t)=>{try{let{date:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"Date is required"});let a=await r.find({BookingDate:s}),i=[];if(a.length)for(let e of a)i.push(e.TimeSlot);return t.status(200).send({status:!0,message:"Success",date:s,bookedSlots:i})}catch(e){return t.status(400).send({status:!1,message:e.message})}},getUserAllBookings:async(e,t)=>{try{let{userId:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"userId is required"});let a=await i.findOne({userId:s});if(!a)return t.status(404).send({status:!1,message:"User Not Found"});let n=await r.find({userId:a.userId});return t.status(200).send({status:!0,message:"Success",data:n})}catch(e){return t.status(400).send({status:!1,message:e.message})}},getAllBookings:async(e,t)=>{try{let{key:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"Key is required"});if(s===n){let e=await r.find({});return t.status(200).send({status:!0,message:"Success",data:e})}return t.status(403).send({status:!1,message:"NOT AUTHORIZED!!!"})}catch(e){return t.status(400).send({status:!1,message:e.message})}},getSpecificBooking:async(e,t)=>{try{let{bookingId:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"bookingId is required"});let a=await r.findById(s);return a?t.status(200).send({status:!0,message:"Success",data:a}):t.status(404).send({status:!1,message:"No booking found with this booking id"})}catch(e){return t.status(400).send({status:!1,message:e.message})}},updateBookingStatus:async(e,t)=>{try{const{bookingId:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"Booking Id is required"});const{status:i,question:n,feedback:d}=e.body;if(!i)return t.status(400).send({status:!1,message:"status is required"});if(!a(s))return t.status(400).send({status:!1,message:"Invalid Booking Id"});let u=await r.findById(s);return u?(u.booking_status=i,u.question=n||"",u.feedback=d||"",await u.save(),t.status(200).send({status:!0,message:"Booking status updated successfully",data:u})):t.status(200).send({status:!0,message:"Booking Not Found"})}catch(e){return t.status(400).send({status:!1,message:e.message})}}}},452:(e,t,s)=>{const a=s(4406);let{getCurrentIPAddress:r}=s(8093);const i=s(3903),n=s(6928),d=s(9896),{port:u,adminSecretKey:o}=s(669),l=s(9307),{isValidObjectId:c}=s(6037),m=s(4475);e.exports={addCategory:async(e,t)=>{try{let{key:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"key is required"});if(s!==o)return t.status(401).send({status:!1,message:"Not authorized"});let{name:l,description:c}=e.body;if(!l||!c)return t.status(400).send({status:!1,message:"All fields are required"});let{File_Extension:m,File_Path:g,File_data:p,File_name:y}=e.body.FileUpload,f=Buffer.from(p,"base64"),I=n.join(__dirname,"..","..","categoryImages");d.existsSync(I)||d.mkdirSync(I);let h=r(),S="/categoryImages/",_=i.v4()+m,k=`http://${h}:${u}${S}`,b=n.join(__dirname,"..","..","categoryImages",_);d.writeFileSync(b,f);let v={name:l,description:c,category_image:{fileName:_,filePath:k}},w=await a.create(v);return t.status(200).send({status:!0,message:"Category Added",data:w})}catch(s){let a={stack:s.stack,details:s.details||"No additional details provided",timestamp:(new Date).toISOString(),ip:e.ip,method:e.method,url:e.originalUrl};return m.error(`Error in addCategory API: ${s.message}`,{meta:a}),t.status(400).send({status:!1,message:s.message})}},getCategoryById:async(e,t)=>{try{let s,{categoryId:r}=e.params;if(r){if(!c(r))return t.status(400).send({status:!1,message:"Invalid category Id"});s=await a.findById(r)}if(!s)return t.status(200).send({status:!0,message:"Category Not Found"});let i=await l.find({category:s._id});return t.status(200).send({status:!0,message:"Success",data:s,products:i})}catch(s){let a={stack:s.stack,details:s.details||"No additional details provided",timestamp:(new Date).toISOString(),ip:e.ip,method:e.method,url:e.originalUrl};return m.error(`Error in getCategoryById API: ${s.message}`,{meta:a}),t.status(400).send({status:!1,message:s.message})}},getProductByKeywords:async(e,t)=>{try{let{service_search:s}=e.body;if(!s)return t.status(400).send({status:!1,message:"Search parameter is required"});let a={$or:[{name:{$regex:s,$options:"i"}},{subTitle:{$regex:s,$options:"i"}},{description:{$regex:s,$options:"i"}}]},r=await l.find(a);return t.status(200).send({status:!0,message:"Success",products:r})}catch(s){let a={stack:s.stack,details:s.details||"No additional details provided",timestamp:(new Date).toISOString(),ip:e.ip,method:e.method,url:e.originalUrl};return m.error(`Error in getProductByKeywords API: ${s.message}`,{meta:a}),t.status(400).send({status:!1,message:s.message})}},getAllCategories:async(e,t)=>{try{let{key:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"Bad Request!!!"});if(s!==o)return t.status(403).send({status:!1,message:"NOT AUTHORIZED!!!"});let r=await a.find({});return t.status(200).send({status:!0,message:"Success",data:r})}catch(s){let a={stack:s.stack,details:s.details||"No additional details provided",timestamp:(new Date).toISOString(),ip:e.ip,method:e.method,url:e.originalUrl};return m.error(`Error in getAllCategories API: ${s.message}`,{meta:a}),t.status(400).send({status:!1,message:s.message})}},updateCategory:async(e,t)=>{try{let{key:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"Bad Request!!!"});if(s!==o)return t.status(403).send({status:!1,message:"NOT AUTHORIZED!!!"});let{categoryId:l}=e.params;if(!l)return t.status(400).send({status:!1,message:"Category Id is required"});if(!c(l))return t.status(400).send({status:!1,message:"Invalid Category Id"});let m=await a.findById(l);if(!m)return t.status(404).send({status:!1,message:"Category Not Found"});let g=e.body;if("name"in g&&(m.name=g.name),"description"in g&&(m.description=g.description),"FileUpload"in g){let{File_Extension:t,File_Path:s,File_data:a,File_name:o}=e.body.FileUpload,l=Buffer.from(a,"base64"),c=r(),g="/categoryImages/",p=i.v4()+t,y=`http://${c}:${u}${g}`,f=n.join(__dirname,"..","..","categoryImages",p),I=m.category_image.fileName,h=n.join(__dirname,"..","..","categoryImages",I);d.existsSync(h)&&d.unlinkSync(h),d.writeFileSync(f,l);let S={fileName:p,filePath:y};m.category_image=S}return await m.save(),t.status(200).send({status:!0,message:"Category updated successfully",data:m})}catch(s){let a={stack:s.stack,details:s.details||"No additional details provided",timestamp:(new Date).toISOString(),ip:e.ip,method:e.method,url:e.originalUrl};return m.error(`Error in updateCategory API: ${s.message}`,{meta:a}),t.status(400).send({status:!1,message:s.message})}},deleteCategory:async(e,t)=>{try{let{key:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"Bad Request!!!"});if(s!==o)return t.status(403).send({status:!1,message:"NOT AUTHORIZED!!!"});let{categoryId:r}=e.params;return r?await a.findById(r)?(await a.deleteOne({_id:r}),t.status(200).send({status:!0,message:"Category deleted successfully"})):t.status(404).send({status:!1,message:"No category found with this category Id"}):t.status(400).send({status:!1,message:"CategoryId is required"})}catch(s){let a={stack:s.stack,details:s.details||"No additional details provided",timestamp:(new Date).toISOString(),ip:e.ip,method:e.method,url:e.originalUrl};return m.error(`Error in deleteCategory API: ${s.message}`,{meta:a}),t.status(400).send({status:!1,message:s.message})}}}},8295:(e,t,s)=>{const a=s(4475),r=s(2357),i=(s(7013),s(6928)),n=s(9896),d=s(3903),{isValidObjectId:u}=s(6037);let{getCurrentIPAddress:o}=s(8093),{port:l}=s(669);e.exports={createClassSchedule:async(e,t)=>{try{const{courseId:s,meeting_link:a,teacherId:u,techer_name:c,input_text:m,youtube_video_code:g,status:p}=e.body;let y=null;if("pdf_file"in e.body||e.files&&e.files.pdf_file){let{pdf_file:s}=e.files;if(!s)return t.status(400).send({status:!1,message:"No pdf file uploaded"});let a=i.join(__dirname,"..","..","class_pdf");n.existsSync(a)||n.mkdirSync(a);let r=o(),u="/class_pdf/",c=d.v4()+"."+s.name.split(".").pop(),m=`http://${r}:${l}${u}`,g=i.join(__dirname,"..","..","class_pdf",c);s.mv(g,(e=>{if(e)throw e})),y={fileName:c,filePath:m}}const f={courseId:s,meeting_link:a,teacherId:u,techer_name:c,input_text:m,pdf_upload_file:y,youtube_video_code:g,status:p};let I=await r.create(f);return t.status(201).send({status:!0,message:"Class schedule created successfully",data:I})}catch(s){let r={stack:s.stack,details:s.details||"No additional details provided",timestamp:(new Date).toISOString(),ip:e.ip,method:e.method,url:e.originalUrl};return a.error(`Error in createClassSchedule API: ${s.message}`,{meta:r}),t.status(500).send({status:!1,message:s.message})}},getAllClassSchedule:async(e,t)=>{try{const e=await r.find({});return t.status(201).send({status:!0,message:"Class schedule created successfully",data:e})}catch(s){let r={stack:s.stack,details:s.details||"No additional details provided",timestamp:(new Date).toISOString(),ip:e.ip,method:e.method,url:e.originalUrl};return a.error(`Error in getAllClassSchedule API: ${s.message}`,{meta:r}),t.status(500).send({status:!1,message:s.message})}},getSchedule:async(e,t)=>{try{const{courseId:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"CourseId is required"});if(!u(s))return t.status(400).send({status:!1,message:"Invalid courseId"});let a=await r.findById(s);return a?t.status(201).send({status:!0,message:"Success",data:a}):t.status(400).send({status:!1,message:"Class schedule not found"})}catch(s){let r={stack:s.stack,details:s.details||"No additional details provided",timestamp:(new Date).toISOString(),ip:e.ip,method:e.method,url:e.originalUrl};return a.error(`Error in getSchedule API: ${s.message}`,{meta:r}),t.status(500).send({status:!1,message:s.message})}},updateSchedule:async(e,t)=>{try{const{courseId:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"CourseId is required"});if(!u(s))return t.status(400).send({status:!1,message:"Invalid courseId"});let a=await r.findById(s);if(!a)return t.status(400).send({status:!1,message:"Class schedule not found"});const c=e.body;if("meeting_link"in c&&(a.meeting_link=c.meeting_link),"techer_name"in c&&(a.techer_name=c.techer_name),"input_text"in c&&(a.input_text=c.input_text),"youtube_video_code"in c&&(a.youtube_video_code=c.youtube_video_code),"status"in c&&(a.status=c.status),"pdf_file"in e.body||e.files&&e.files.pdf_file){if(a.pdf_upload_file.fileName){let e=i.join(__dirname,"..","..","class_pdf");n.existsSync(e)&&n.unlinkSync(e)}let{pdf_file:s}=e.files;if(!s)return t.status(400).send({status:!1,message:"No pdf file uploaded"});let r=i.join(__dirname,"..","..","class_pdf");n.existsSync(r)||n.mkdirSync(r);let u=o(),c="/class_pdf/",m=d.v4()+"."+s.name.split(".").pop(),g=`http://${u}:${l}${c}`,p=i.join(__dirname,"..","..","class_pdf",m);s.mv(p,(e=>{if(e)throw e}));let y={fileName:m,filePath:g};a.pdf_upload_file=y}return await a.save(),t.status(201).send({status:!0,message:"Schedule updated successfully",data:a})}catch(s){let r={stack:s.stack,details:s.details||"No additional details provided",timestamp:(new Date).toISOString(),ip:e.ip,method:e.method,url:e.originalUrl};return a.error(`Error in updateSchedule API: ${s.message}`,{meta:r}),t.status(500).send({status:!1,message:s.message})}},deleteSchedule:async(e,t)=>{try{const{courseId:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"CourseId is required"});if(!u(s))return t.status(400).send({status:!1,message:"Invalid courseId"});let a=await r.findById(s);if(!a)return t.status(400).send({status:!1,message:"Class schedule not found"});let d=a.pdf_upload_file.fileName;if(d){let e=i.join(__dirname,"..","..","class_pdf",d);n.existsSync(e)&&n.unlinkSync(e)}return await r.deleteOne({courseId:s})?t.status(201).send({status:!0,message:"Schedule deleted successfully"}):t.status(404).send({status:!1,message:"Schedule not found or alrady deleted"})}catch(s){let r={stack:s.stack,details:s.details||"No additional details provided",timestamp:(new Date).toISOString(),ip:e.ip,method:e.method,url:e.originalUrl};return a.error(`Error in deleteSchedule API: ${s.message}`,{meta:r}),t.status(500).send({status:!1,message:s.message})}}}},9957:(e,t,s)=>{const a=s(7013),r=s(6928),i=s(9896),n=s(3903),d=s(4475),{isValidObjectId:u}=s(6037);let{getCurrentIPAddress:o}=s(8093),{port:l,adminSecretKey:c}=s(669);e.exports={addCourse:async(e,t)=>{try{const{key:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"Key is required"});if(s!==c)return t.status(401).send({status:!1,message:"Not Authorized"});const{categoryId:d,category_name:u,course_name:m,description:g,course_fee:p,duration:y,start_date:f,end_date:I,class_time:h,course_seat_limit:S,offer_in_amount:_,coutse_type:k}=e.body;let b=null;if("FileUpload"in e.body){let{File_Extension:t,File_Path:s,File_data:a,File_name:d}=e.body.FileUpload,u=Buffer.from(a,"base64"),c=r.join(__dirname,"..","..","courseImages");i.existsSync(c)||i.mkdirSync(c);let m=o(),g="/courseImages/",p=n.v4()+"."+course_image.name.split(".").pop(),y=`http://${m}:${l}${g}`,f=r.join(__dirname,"..","..","courseImages",p);i.writeFileSync(f,u),b={fileName:p,filePath:y}}let v={categoryId:d,category_name:u,course_name:m,description:g,course_fee:p,duration:y,start_date:f,end_date:I,class_time:h,course_seat_limit:S,offer_in_amount:_,coutse_type:k,course_image:b},w=await a.create(v);return t.status(201).send({status:!0,message:"Course created successfully",data:w})}catch(s){let a={stack:s.stack,details:s.details||"No additional details provided",timestamp:(new Date).toISOString(),ip:e.ip,method:e.method,url:e.originalUrl};return d.error(`Error in addCourse API: ${s.message}`,{meta:a}),t.status(500).send({status:!1,message:s.message})}},getAllCourses:async(e,t)=>{try{let e=await a.find({});return t.status(201).send({status:!0,message:"Success",data:e})}catch(s){let a={stack:s.stack,details:s.details||"No additional details provided",timestamp:(new Date).toISOString(),ip:e.ip,method:e.method,url:e.originalUrl};return d.error(`Error in getAllCourses API: ${s.message}`,{meta:a}),t.status(500).send({status:!1,message:s.message})}},getCourseById:async(e,t)=>{try{const{courseId:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"CourseId is required"});if(!u(s))return t.status(400).send({status:!1,message:"Invalid courseId"});let r=await a.findById(s);return r?t.status(201).send({status:!0,message:"Success",data:r}):t.status(400).send({status:!1,message:"Course not found"})}catch(s){let a={stack:s.stack,details:s.details||"No additional details provided",timestamp:(new Date).toISOString(),ip:e.ip,method:e.method,url:e.originalUrl};return d.error(`Error in getCourseById API: ${s.message}`,{meta:a}),t.status(500).send({status:!1,message:s.message})}},updateCourse:async(e,t)=>{try{const{courseId:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"CourseId is required"});if(!u(s))return t.status(400).send({status:!1,message:"Invalid courseId"});let d=await a.findById(s);if(!d)return t.status(400).send({status:!1,message:"Course not found"});let c=e.body;if("category_name"in c&&(d.category_name=c.category_name),"course_name"in c&&(d.course_name=c.course_name),"description"in c&&(d.description=c.description),"course_fee"in c&&(d.course_fee=c.course_fee),"duration"in c&&(d.duration=c.duration),"start_date"in c&&(d.start_date=c.start_date),"end_date"in c&&(d.end_date=c.end_date),"class_time"in c&&(d.class_time=c.class_time),"course_seat_limit"in c&&(d.course_seat_limit=c.course_seat_limit),"offer_in_amount"in c&&(d.offer_in_amount=c.offer_in_amount),"coutse_type"in c&&(d.coutse_type=c.coutse_type),"FileUpload"in e.body){let t=d.course_image.fileName;if(t){let e=r.join(__dirname,"..","..","courseImages",t);i.existsSync(e)&&i.unlinkSync(e)}let{File_Extension:s,File_Path:a,File_data:u,File_name:c}=e.body.FileUpload,m=Buffer.from(u,"base64"),g=o(),p="/courseImages/",y=n.v4()+"."+course_image.name.split(".").pop(),f=`http://${g}:${l}${p}`,I=r.join(__dirname,"..","..","courseImages",y);i.writeFileSync(I,m);let h={fileName:y,filePath:f};d.course_image=h}return await d.save(),t.status(201).send({status:!0,message:"Course updated successfully",data:d})}catch(s){let a={stack:s.stack,details:s.details||"No additional details provided",timestamp:(new Date).toISOString(),ip:e.ip,method:e.method,url:e.originalUrl};return d.error(`Error in updateCourse API: ${s.message}`,{meta:a}),t.status(500).send({status:!1,message:s.message})}},deleteCourse:async(e,t)=>{try{const{courseId:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"CourseId is required"});if(!u(s))return t.status(400).send({status:!1,message:"Invalid courseId"});let n=await a.findById(s);if(!n)return t.status(400).send({status:!1,message:"Course not found"});let d=n.course_image.fileName;if(d){let e=r.join(__dirname,"..","..","courseImages",d);i.existsSync(e)&&i.unlinkSync(e)}if(!await a.deleteOne({_id:s}))return t.status(400).send({status:!1,message:"Course not found or already deleted"})}catch(s){let a={stack:s.stack,details:s.details||"No additional details provided",timestamp:(new Date).toISOString(),ip:e.ip,method:e.method,url:e.originalUrl};return d.error(`Error in deleteCourse API: ${s.message}`,{meta:a}),t.status(500).send({status:!1,message:s.message})}}}},3974:(e,t,s)=>{const a=s(8116),r=(s(1935),s(7013),s(4475));e.exports={purchaseCourse:async(e,t)=>{try{let{courseId:s,amount:r,status:i,userId:n,notes:d}=e.body,u={courseId:s,amount:r,status:i,userId:n,notes:d},o=await a.create(u);return t.status(201).send({status:!0,message:"Course purchased successfully",data:o})}catch(s){let a={stack:s.stack,details:s.details||"No additional details provided",timestamp:(new Date).toISOString(),ip:e.ip,method:e.method,url:e.originalUrl};return r.error(`Error in purchaseCourse API: ${s.message}`,{meta:a}),t.status(500).send({status:!1,message:s.message})}},getPurchasedCourse:async(e,t)=>{try{const{purchaseId:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"purchaseId is required"});if(!isValidObjectId(s))return t.status(400).send({status:!1,message:"Invalid purchaseId"});let r=await a.findById(s);return r?t.status(201).send({status:!0,message:"Success",data:r}):t.status(400).send({status:!1,message:"Purchased course not found"})}catch(s){let a={stack:s.stack,details:s.details||"No additional details provided",timestamp:(new Date).toISOString(),ip:e.ip,method:e.method,url:e.originalUrl};return r.error(`Error in getPurchasedCourse API: ${s.message}`,{meta:a}),t.status(500).send({status:!1,message:s.message})}},getAllPurchasedCourses:async(e,t)=>{try{const{userId:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"userId is required"});let r=await a.find({userId:s});return t.status(201).send({status:!0,message:"Success",data:r})}catch(s){let a={stack:s.stack,details:s.details||"No additional details provided",timestamp:(new Date).toISOString(),ip:e.ip,method:e.method,url:e.originalUrl};return r.error(`Error in getAllPurchasedCourses API: ${s.message}`,{meta:a}),t.status(500).send({status:!1,message:s.message})}},updatePurchasedCourseDetails:async(e,t)=>{try{const{purchaseId:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"purchaseId is required"});if(!isValidObjectId(s))return t.status(400).send({status:!1,message:"Invalid purchaseId"});let r=await a.findById(s);if(!r)return t.status(400).send({status:!1,message:"Purchased course not found"});const i=e.body;return"amount"in i&&(r.amount=i.amount),"status"in i&&(r.status=i.status),"notes"in i&&(r.notes=i.notes),await r.save(),t.status(201).send({status:!0,message:"Details updated successfully",data:r})}catch(s){let a={stack:s.stack,details:s.details||"No additional details provided",timestamp:(new Date).toISOString(),ip:e.ip,method:e.method,url:e.originalUrl};return r.error(`Error in updatePurchasedCourseDetails API: ${s.message}`,{meta:a}),t.status(500).send({status:!1,message:s.message})}},deletePurchaseDetails:async(e,t)=>{try{const{purchaseId:s}=e.params;return s?isValidObjectId(s)?await a.deleteOne({_id:s})?t.status(201).send({status:!0,message:"Purchase details deleted successfully"}):t.status(400).send({status:!1,message:"Purchase details not found or already deleted"}):t.status(400).send({status:!1,message:"Invalid purchaseId"}):t.status(400).send({status:!1,message:"purchaseId is required"})}catch(s){let a={stack:s.stack,details:s.details||"No additional details provided",timestamp:(new Date).toISOString(),ip:e.ip,method:e.method,url:e.originalUrl};return r.error(`Error in deletePurchaseDetails API: ${s.message}`,{meta:a}),t.status(500).send({status:!1,message:s.message})}}}},9506:(e,t,s)=>{const a=s(5935),r=s(4406),i=s(1165),n=s(3751),{getCurrentIPAddress:d}=s(8093),u=s(3903),o=s(6928),l=s(9896),{port:c,adminSecretKey:m}=s(669),{isValidObjectId:g}=s(6037),p=s(4475);e.exports={getDashboard:async(e,t)=>{try{let{userId:s}=e.params,d=await r.find({}),u=await i.find({}),o=null;s&&(o=await a.find({userId:s}));let l,c=await n.findOne({});return c&&(l=c.bannerImages?c.bannerImages:null),t.status(200).send({status:!0,message:"Success",categoryList:d,superdealList:u,bookingList:o,bannerImages:l||[]})}catch(s){let a={stack:s.stack,details:s.details||"No additional details provided",timestamp:(new Date).toISOString(),ip:e.ip,method:e.method,url:e.originalUrl};return p.error(`Error in getDashboard API: ${s.message}`,{meta:a}),t.status(400).send({status:!1,message:s.message})}},updateBannerImages:async(e,t)=>{try{let{key:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"Bad Request!!!"});if(s!==m)return t.status(403).send({status:!1,message:"NOT AUTHORIZED!!!"});let a=await n.findOne({});a||(a=await n.create({bannerImages:[]}));let{ImageModel:r}=e.body,i=JSON.parse(r),g=e.files.bannerImage;if(!g)return t.status(400).send({status:!1,message:"No banner image uploaded"});let p=i.index,y=(i.img_id&&i.img_id,i.imageName,i.isNewPick),f=d(),I="/bannerImages/",h=u.v4()+"."+g.name.split(".").pop(),S=`http://${f}:${c}${I}`,_=o.join(__dirname,"..","..","bannerImages",h);if(y){g.mv(_,(e=>{if(e)throw e}));let e={imageName:h,imagePath:S};a.bannerImages.push(e),await a.save();let s=a.bannerImages;return t.status(200).send({status:!0,message:"Banner added successfully",data:s})}{let e=a.bannerImages[p].imageName,s=o.join(__dirname,"..","..","bannerImages",e);l.unlinkSync(s),g.mv(_,(e=>{if(e)throw e}));let r={imageName:h,imagePath:S};a.bannerImages[p]=r,await a.save();let i=a.bannerImages;return t.status(200).send({status:!0,message:"Banner updated successfully",data:i})}}catch(s){let a={stack:s.stack,details:s.details||"No additional details provided",timestamp:(new Date).toISOString(),ip:e.ip,method:e.method,url:e.originalUrl};return p.error(`Error in updateBannerImages API: ${s.message}`,{meta:a}),t.status(400).send({status:!1,message:s.message})}},deleteBannerImage:async(e,t)=>{try{let{imageId:s,key:a}=e.params;if(!s||!a)return t.status(400).send({status:!1,message:"All fields are required"});if(a!==m)return t.status(403).send({status:!1,message:"NOT AUTHORIZED!!!"});let r=await n.findOne();if(!r)return t.status(400).send({status:!1,message:"Not Found!!!"});if(r.bannerImages.length)for(let e=0;e<r.bannerImages.length;e++)if(s===r.bannerImages[e]._id.toString()){let t=r.bannerImages[e].imageName,s=o.join(__dirname,"..","..","bannerImages",t);l.existsSync(s)&&l.unlinkSync(s);let a=r.bannerImages;a.splice(e,1),r.bannerImages=a,await r.save()}let i=r.bannerImages;return t.status(200).send({status:!0,message:"Banner deleted successfully",data:i})}catch(s){let a={stack:s.stack,details:s.details||"No additional details provided",timestamp:(new Date).toISOString(),ip:e.ip,method:e.method,url:e.originalUrl};return p.error(`Error in deleteBannerImage API: ${s.message}`,{meta:a}),t.status(400).send({status:!1,message:s.message})}}}},7001:(e,t,s)=>{const a=s(9307),r=(s(4406),s(1165));let{getCurrentIPAddress:i}=s(8093);const n=s(3903),d=s(6928),u=s(9896),{port:o,adminSecretKey:l}=s(669),{isValidObjectId:c}=s(6037);e.exports={addProduct:async(e,t)=>{try{let{key:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"key is required"});if(s!==l)return t.status(403).send({status:!1,message:"NOT AUTHORIZED!!!"});let c,{name:m,subTitle:g,description:p,category:y,price:f,stock_item:I,status:h,discount:S}=e.body,{File_Extension:_,File_Path:k,File_data:b,File_name:v}=e.body.FileUpload,w=Buffer.from(b,"base64"),A=i();c=y||e.body.category?"/productImages/":"/superdealImages/";let N,T=n.v4()+_,P=`http://${A}:${o}${c}`;N=y||e.body.category?d.join(__dirname,"..","..","productImages",T):d.join(__dirname,"..","..","superdealImages",T),u.writeFileSync(N,w);let O,B={name:m,subTitle:g,description:p,price:f,stock_item:I,service_image:{imageName:T,imagePath:P},status:h,discount:S};return y||e.body.category?(B.category=y,O=await a.create(B)):O=await r.create(B),t.status(200).send({status:!0,message:"Product Added Successfully",data:O})}catch(e){return t.status(400).send({status:!1,message:e.message})}},getProduct:async(e,t)=>{try{let{productId:s,key:r}=e.params;if(!s||!r)return t.status(400).send({status:!1,message:"All fields are required"});if(r!==l)return t.status(403).send({status:!1,message:"NOT AUTHORIZED!!!"});let i=await a.findById(s);return i?t.status(200).send({status:!0,message:"Success",data:i}):t.status(404).send({status:!1,message:"Product Not Found"})}catch(e){return t.status(500).send({status:!1,message:e.message})}},getAllProducts:async(e,t)=>{try{let{key:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"Key is required"});if(s!==l)return t.status(403).send({status:!1,message:"NOT AUTHORIZED!!!"});let r=await a.find({});return t.status(200).send({status:!0,message:"Success",data:r})}catch(e){return t.status(500).send({status:!1,message:e.message})}},updateProduct:async(e,t)=>{try{let{productId:s,key:m}=e.params;if(!s||!m)return t.status(400).send({status:!1,message:"All fields are required"});if(!c(s))return t.status(400).send({status:!1,message:"Invalid Object Id"});if(m!==l)return t.status(403).send({status:!1,message:"NOT AUTHORIZED!!!"});let g=await a.findById(s),p=await r.findById(s);if(!g&&!p)return t.status(404).send({status:!1,message:"Item not found"});let y=e.body;if(g){if("name"in y&&(g.name=y.name),"subTitle"in y&&(g.subTitle=y.subTitle),"description"in y&&(g.description=y.description),"price"in y&&(g.price=y.price),"stock_items"in y&&(g.stock_items=y.stock_items),"status"in y&&(g.status=y.status),"discount"in y&&(g.discount=y.discount),"FileUpload"in y){let{File_Extension:t,File_Path:s,File_data:a,File_name:r}=e.body.FileUpload,l=Buffer.from(a,"base64"),c=i(),m="/productImages/",p=n.v4()+t,y=`http://${c}:${o}${m}`,f=d.join(__dirname,"..","..","productImages",p),I=g.service_image.imageName,h=d.join(__dirname,"..","..","productImages",I);u.existsSync(h)&&u.unlinkSync(h),u.writeFileSync(f,l);let S={imageName:p,imagePath:y};g.service_image=S}return await g.save(),t.status(200).send({status:!0,message:"Product Updated Successfully",data:g})}if("name"in y&&(p.name=y.name),"subTitle"in y&&(p.subTitle=y.subTitle),"description"in y&&(p.description=y.description),"price"in y&&(p.price=y.price),"stock_items"in y&&(p.stock_items=y.stock_items),"status"in y&&(p.status=y.status),"discount"in y&&(p.discount=y.discount),"FileUpload"in y){let{File_Extension:t,File_Path:s,File_data:a,File_name:r}=e.body.FileUpload,l=Buffer.from(a,"base64"),c=i(),m="/superdealImages/",g=n.v4()+t,y=`http://${c}:${o}${m}`,f=d.join(__dirname,"..","..","superdealImages",g),I=p.service_image.imageName,h=d.join(__dirname,"..","..","superdealImages",I);u.existsSync(h)&&u.unlinkSync(h),u.writeFileSync(f,l);let S={imageName:g,imagePath:y};p.service_image=S}return await p.save(),t.status(200).send({status:!0,message:"Superdeal Updated Successfully",data:p})}catch(e){return t.status(500).send({status:!1,message:e.message})}},deleteProduct:async(e,t)=>{try{let{productId:s,key:i}=e.params;if(!s||!i)return t.status(400).send({status:!1,message:"All fields are required"});if(!c(s))return t.status(400).send({status:!1,message:"Invalid objectId"});if(i!==l)return t.status(403).send({status:!1,message:"NOT AUTHORIZED!!!"});let n=await a.findById(s),o=await r.findById(s);if(!n&&!o)return t.status(404).send({status:!1,message:"Item not found"});if(n){let e=n.service_image.imageName,t=d.join(__dirname,"..","..","productImages",e);u.existsSync(t)&&u.unlinkSync(t),await a.deleteOne({_id:s})}else{let e=o.service_image.imageName,t=d.join(__dirname,"..","..","superdealImages",e);u.existsSync(t)&&u.unlinkSync(t),await r.deleteOne({_id:s})}return t.status(200).send({status:!0,message:"Item deleted successfully"})}catch(e){return t.status(500).send({status:!1,message:e.message})}}}},9903:(e,t,s)=>{const a=s(1165);let{getCurrentIPAddress:r}=s(8093);const i=s(3903),n=s(6928),d=s(9896),{port:u}=s(669),{isValidObjectId:o}=s(6037);e.exports={addSuperDeal:async(e,t)=>{try{let{name:s,subTitle:d,description:o,category:l,price:c,stock_items:m,status:g,discount:p}=e.body,{service_image:y}=e.files;if(!y)return t.status(400).send({status:!1,message:"No superdeal image uploaded"});let f=r(),I="/superdealImages/",h=i.v4()+"."+y.name.split(".").pop(),S=`http://${f}:${u}${I}`,_=n.join(__dirname,"..","..","superdealImages",h);y.mv(_,(e=>{if(e)throw e}));let k={name:s,subTitle:d,description:o,category:l,price:c,stock_items:m,status:g,service_image:{imageName:h,imagePath:S},discount:p},b=await a.create(k);return t.status(200).send({status:!0,message:"Success",data:b})}catch(e){return t.status(400).send({status:!1,message:e.message})}},getSuperdealById:async(e,t)=>{try{let{superdealId:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"Super Admin Id is required"});let r=await a.findById(s);return r?t.status(200).send({status:!0,message:"Success",data:r}):t.status(404).send({status:!1,message:"Not Found"})}catch(e){return t.status(400).send({status:!1,message:e.message})}},getAllSuperdeals:async(e,t)=>{try{let e=await a.find({});return t.status(200).send({status:!0,message:"Success",data:e})}catch(e){return t.status(400).send({status:!1,message:e.message})}},updateSuperdeal:async(e,t)=>{try{let{superdealId:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"Superdeal Id is required"});if(!o(s))return t.status(400).send({status:!1,message:"Invalid Superdeal Id"});let l=await a.findById(s);if(!l)return t.status(404).send({status:!1,message:"No Superdeal found with this Id"});let c=e.body;if("name"in c&&(l.name=c.name),"subTitle"in c&&(l.subTitle=c.subTitle),"description"in c&&(l.description=c.description),"price"in c&&(l.price=c.price),"stock_items"in c&&(l.stock_items=c.price),"status"in c&&(l.status=c.status),"discount"in c&&(l.discount=c.discount),"service_image"in c||e.files&&e.files.service_image){let s=e.files.service_image;if(!s)return t.status(400).send({status:!1,message:"No service image uploaded"});let a=r(),o="/superdealImages/",c=i.v4()+"."+s.name.split(".").pop(),m=`http://${a}:${u}${o}`,g=n.join(__dirname,"..","..","superdealImages",c),p=l.service_image.imageName,y=n.join(__dirname,"..","..","superdealImages",p);d.unlinkSync(y),s.mv(g,(e=>{if(e)throw e}));let f={imageName:c,imagePath:m};l.service_image=f}return await l.save(),t.status(200).send({status:!0,message:"Superdeal updated successfully",data:l})}catch(e){return t.status(400).send({status:!1,message:e.message})}},deleteSuperdeal:async(e,t)=>{try{let{superdealId:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"Superdeal Id is required"});let r=await a.findById(s);if(!r)return t.status(404).send({status:!1,message:"Not Found"});let i=r.service_image.imageName,u=n.join(__dirname,"..","..","superdealImages",i);return d.unlinkSync(u),await a.deleteOne({_id:s}),t.status(200).send({status:!0,message:"Success"})}catch(e){return t.status(400).send({status:!1,message:e.message})}}}},5196:(e,t,s)=>{const a=s(9760),r=s(6928),i=s(9896),n=s(3903),{isValidObjectId:d}=s(6037);let{getCurrentIPAddress:u}=s(8093),{port:o,adminSecretKey:l}=s(669);const c=s(4475);e.exports={addTeacher:async(e,t)=>{try{let{key:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"key is required"});if(s!==l)return t.status(401).send({status:!1,message:"Not authorized"});let{name:d,description:c}=e.body,m=null;if("FileUpload"in e.body){let{File_Extension:t,File_Path:s,File_data:a,File_name:d}=e.body.FileUpload,l=Buffer.from(a,"base64"),c=r.join(__dirname,"..","..","uploads");i.existsSync(c)||i.mkdirSync(c);let g=u(),p="/uploads/",y=n.v4()+t,f=`http://${g}:${o}${p}`,I=r.join(__dirname,"..","..","uploads",y);i.writeFileSync(I,l),m={fileName:y,filePath:f}}let g={name:d,description:c,profilePic:m},p=await a.create(g);return t.status(201).send({status:!0,message:"Teacher added successfully",data:p})}catch(s){let a={stack:s.stack,details:s.details||"No additional details provided",timestamp:(new Date).toISOString(),ip:e.ip,method:e.method,url:e.originalUrl};return c.error(`Error in addTeacher API: ${s.message}`,{meta:a}),t.status(500).send({status:!1,message:s.message})}},getAllTeachers:async(e,t)=>{try{let{key:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"key is required"});if(s!==l)return t.status(401).send({status:!1,message:"Not authorized"});let r=await a.find({});return t.status(200).send({status:!0,message:"Success",data:r})}catch(s){let a={stack:s.stack,details:s.details||"No additional details provided",timestamp:(new Date).toISOString(),ip:e.ip,method:e.method,url:e.originalUrl};return c.error(`Error in getAllTeachers API: ${s.message}`,{meta:a}),t.status(500).send({status:!1,message:s.message})}},getTeacherById:async(e,t)=>{try{let{key:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"key is required"});if(s!==l)return t.status(401).send({status:!1,message:"Not authorized"});const{teacherId:r}=e.params;if(!r)return t.status(400).send({status:!1,message:"TeacherId is required"});if(!d(r))return t.status(400).send({status:!1,message:"Invalid teacherId"});let i=await a.findById(r);return i?t.status(201).send({status:!0,message:"Success",data:i}):t.status(400).send({status:!1,message:"Teacher not found"})}catch(s){let a={stack:s.stack,details:s.details||"No additional details provided",timestamp:(new Date).toISOString(),ip:e.ip,method:e.method,url:e.originalUrl};return c.error(`Error in getTeacherById API: ${s.message}`,{meta:a}),t.status(500).send({status:!1,message:s.message})}},updateTeacher:async(e,t)=>{try{const{teacherId:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"TeacherId is required"});if(!d(s))return t.status(400).send({status:!1,message:"Invalid teacherId"});let l=await a.findById(s);if(!l)return t.status(400).send({status:!1,message:"Teacher not found"});let c=e.body;if("name"in c&&(l.name=c.name),"description"in c&&(l.description=c.description),"FileUpload"in c){if(l.profilePic.fileName){let e=r.join(__dirname,"..","..","uploads");i.existsSync(e)&&i.unlinkSync(e)}let{File_Extension:t,File_Path:s,File_data:a,File_name:d}=e.body.FileUpload,c=Buffer.from(a,"base64"),m=r.join(__dirname,"..","..","uploads");i.existsSync(m)||i.mkdirSync(m);let g=u(),p="/uploads/",y=n.v4()+"."+profilePic.name.split(".").pop(),f=`http://${g}:${o}${p}`,I=r.join(__dirname,"..","..","uploads",y);i.writeFileSync(I,c);let h={fileName:y,filePath:f};l.profilePic=h}return await l.save(),t.status(201).send({status:!0,message:"Teacher data updated successfully",data:l})}catch(s){let a={stack:s.stack,details:s.details||"No additional details provided",timestamp:(new Date).toISOString(),ip:e.ip,method:e.method,url:e.originalUrl};return c.error(`Error in updateTeacher API: ${s.message}`,{meta:a}),t.status(500).send({status:!1,message:s.message})}},deleteTeacher:async(e,t)=>{try{const{teacherId:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"TeacherId is required"});if(!d(s))return t.status(400).send({status:!1,message:"Invalid teacherId"});let n=await a.findById(s);if(!n)return t.status(400).send({status:!1,message:"Teacher not found"});let u=n.profilePic.fileName,o=r.join(__dirname,"..","..","uploads",u);return i.existsSync(o)&&i.unlinkSync(o),await a.deleteOne({_id:s}),t.status(201).send({status:!0,message:"Teacher deleted successfully"})}catch(s){let a={stack:s.stack,details:s.details||"No additional details provided",timestamp:(new Date).toISOString(),ip:e.ip,method:e.method,url:e.originalUrl};return c.error(`Error in deleteTeacherById API: ${s.message}`,{meta:a}),t.status(500).send({status:!1,message:s.message})}}}},1579:(e,t,s)=>{const a=s(1935),r=(s(6107),s(2950)),{getCurrentIPAddress:i,generateRandomAlphaNumericID:n}=(s(3903),s(6928),s(9896),s(8093)),{port:d}=s(669),{isValidObjectId:u}=s(6037),o=s(5935),{adminSecretKey:l}=s(669);e.exports={authenticateUser:async(e,t)=>{try{let{email:s,profilePic:r,name:i,userId:n}=e.body;const d=await a.findOne({userId:n});if(d)return t.status(200).send({status:!0,message:"Authentication successful",data:d});{let e={userId:n,name:i,email:s,profilePic:r},d=await a.create(e);return t.status(200).send({status:!0,message:"Authentication successful",data:d})}}catch(e){return t.status(400).send({status:!1,message:e.message})}},updateUser:async(e,t)=>{try{const{userId:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"userId is required"});let r=await a.findOne({userId:s});if(!r)return t.status(400).send({status:!1,message:"User not found"});let i=e.body;return"name"in i&&(r.name=i.name),"phone"in i&&(r.phone=i.phone),"gender"in i&&(r.gender=i.gender),"date_of_birth"in i&&(r.date_of_birth=i.date_of_birth),"Address"in i&&("address"in i.Address&&(r.Address.address=i.Address.address),"apartment"in i.Address&&(r.Address.apartment=i.Address.apartment),"city"in i.Address&&(r.Address.city=i.Address.city),"post_code"in i.Address&&(r.Address.post_code=i.Address.post_code),"state"in i.Address&&(r.Address.state=i.Address.state)),"education"in i&&(r.education=i.education),await r.save(),t.status(200).send({status:!0,message:"User updated successfully",data:r})}catch(e){return t.status(400).send({status:!1,message:e.message})}},deleteUser:async(e,t)=>{try{let{userId:s}=e.params;if(!s)return t.status(400).send({status:!1,message:"userId is required"});let i=await a.findOne({userId:s});if(!i)return t.status(400).send({status:!1,message:"User not found"});const{reason:n,feedback:d}=e.body;let u={user:i,userAllBookings:await o.find({userId:s})},l=JSON.stringify(u);await a.deleteOne({userId:s});let c={userId:s,deletedUserData:l,reason:n,feedback:d,deletedAt:(new Date).toLocaleString()};return await r.create(c),t.status(200).send({status:!0,message:"User deleted successfully"})}catch(e){return t.status(400).send({status:!1,message:e.message})}},getUserById:async(e,t)=>{try{let{userId:s,key:r}=e.params;if(!s||!r)return t.status(400).send({status:!1,message:"All fields are required"});if(r!==l)return t.status(403).send({status:!1,message:"NOT AUTHORIZED!!!"});let i=await a.findOne({userId:s});return i?t.status(200).send({status:!0,message:"Success",data:i}):t.status(400).send({status:!1,message:"User not found"})}catch(e){return t.status(400).send({status:!1,message:e.message})}},getAllUsers:async(e,t)=>{try{let e=await a.find({});return t.status(200).send({status:!0,message:"Success",data:e})}catch(e){return t.status(400).send({status:!1,message:e.message})}}}},3797:e=>{class t extends Error{constructor(e,t,s,a){super(s),this.name=e,this.statusCode=t,this.details=a}}e.exports=t},3526:(e,t,s)=>{const{isValidObjectId:a}=s(6037),{tokenSecretKey:r}=s(669),i=s(6107),n=s(829);e.exports={Authentication:async(e,t,s)=>{try{let a=e.headers.authorization;if(!a)return t.status(400).send({status:!1,message:"Token is required"});let i,d=a.split(" ")[1];if(!d)return t.status(400).send({status:!1,message:"Invalid token"});n.verify(d,r,((t,a)=>{if(t)throw t;i=a;let r=i.adminId;e.adminId=r,s()}))}catch(e){return t.status(500).send({status:!1,message:e.message})}},Authorization:async(e,t,s)=>{try{let r=e.adminId,{adminId:n}=e.params;if(!a(n))return t.status(400).send({status:!1,message:"Invalid userId"});let d=await i.findById(n);if(!d)return t.status(404).send({status:!1,message:"Admin not found"});let u=d._id;if(r.toString()!==u.toString())return t.status(403).send({status:!1,message:"NOT AUTHORIZED!!!"});s()}catch(e){return t.status(500).send({status:!1,message:e.message})}}}},6107:(e,t,s)=>{const a=s(6037),r=(a.Schema.Types.ObjectId,new a.Schema({adminId:{type:String},sessionToken:{type:String},name:{type:String},email:{type:String},password:{type:String},mobile:{type:String},profilePic:{picName:{type:String},picPath:{type:String}}},{timestamps:!0}));e.exports=a.model("Admin",r)},3751:(e,t,s)=>{const a=s(6037),r=new a.Schema({bannerImages:[{imageName:{type:String,default:""},imagePath:{type:String,default:""}}]},{timestamps:!0});e.exports=a.model("BannerImage",r)},5935:(e,t,s)=>{const a=s(6037),r=(a.Schema.Types.ObjectId,new a.Schema({userId:{type:String},bookingId:{type:String},f_name:{type:String,default:""},l_name:{type:String,default:""},email:{type:String},mobile:{type:String},address:{type:String},apartment:{type:String},city:{type:String},state:{type:String},state_code:{type:Number},countryCode:{type:String},countryName:{type:String},post_code:{type:String},productList:[{name:{type:String},subTitle:{type:String},bookingQty:{type:Number},category:{type:String},description:{type:String},discount:{type:String},imgUrl:{type:String},price:{type:Number},status:{type:String},stock_items:{type:Number},subTotal:{type:Number}}],totalProduct:{type:Number},CGST:{type:Number},SGST:{type:Number},total:{type:Number},grand_total:{type:Number,default:0},BookingDate:{type:String,default:""},TimeSlot:{type:String,default:""},booking_status:{type:String,enum:["ONGOING","COMPLETED","CANCELED"],default:"ONGOING"},question:{type:String},feedback:{type:String}},{timestamps:!0}));e.exports=a.model("Booking",r)},4406:(e,t,s)=>{const a=s(6037),r=(a.Schema.Types.ObjectId,new a.Schema({name:{type:String,default:""},description:{type:String,default:""},category_image:{fileName:{type:String,default:""},filePath:{type:String,default:""}},cat_enum:{type:String,enum:["",""]}},{timestamps:!0}));e.exports=a.model("Category",r)},2357:(e,t,s)=>{const a=s(6037),r=(a.Schema.Types.ObjectId,new a.Schema({courseId:{type:String,default:""},meeting_link:{type:String,default:""},teacherId:{type:String,default:""},techer_name:{type:String,default:""},input_text:{type:String,default:""},pdf_upload_file:{fileName:{type:String,default:""},filePath:{type:String,default:""}},youtube_video_code:{type:String,default:""},status:{type:String,default:""}},{timestamps:!0}));e.exports=a.model("Class_Schedule",r)},7013:(e,t,s)=>{const a=s(6037),r=a.Schema.Types.ObjectId,i=new a.Schema({categoryId:{type:r,ref:"Category"},category_name:{type:String,default:""},course_name:{type:String,default:""},description:{type:String,default:""},course_fee:{type:Number,default:0},duration:{type:String,default:""},start_date:{type:String,default:""},end_date:{type:String,default:""},class_time:{type:String,default:""},course_image:{fileName:{type:String,default:""},filePath:{type:String,default:""}},course_seat_limit:{type:Number,default:0},offer_in_amount:{type:Number,default:0},coutse_type:{type:String,default:""}},{timestamps:!0});e.exports=a.model("Course",i)},8116:(e,t,s)=>{const a=s(6037),r=(a.Schema.Types.ObjectId,new a.Schema({courseId:{type:String,default:""},userId:{type:String,default:""},amount:{type:Number,default:0},status:{type:String,default:""},notes:{type:String,default:""}},{timestamps:!0}));e.exports=a.model("CoursePurchase",r)},2950:(e,t,s)=>{const a=s(6037),r=new a.Schema({userId:{type:String},deletedUserData:{type:String},reason:{type:String},feedback:{type:String},deletedAt:{type:String}},{timestamps:!0});e.exports=a.model("DeletedUser",r)},9307:(e,t,s)=>{const a=s(6037),r=a.Schema.Types.ObjectId,i=new a.Schema({name:{type:String,default:""},subTitle:{type:String},description:{type:String,default:""},service_image:{imageName:{type:String},imagePath:{type:String}},category:{type:r,ref:"Category"},price:{type:Number,default:0},stock_items:{type:Number,default:0},status:{type:String,enum:["AVAILABLE","NOT_AVAILABLE"]},discount:{type:String}},{timestamps:!0});e.exports=a.model("Product",i)},1165:(e,t,s)=>{const a=s(6037),r=a.Schema.Types.ObjectId,i=new a.Schema({name:{type:String,default:""},subTitle:{type:String,default:""},description:{type:String,default:""},service_image:{imageName:{type:String},imagePath:{type:String}},category:{type:r,ref:"Category"},price:{type:Number,default:0},stock_items:{type:Number,default:0},status:{type:String,enum:["AVAILABLE","NOT_AVAILABLE"]},discount:{type:String}},{timestamps:!0});e.exports=a.model("Superdeal",i)},9760:(e,t,s)=>{const a=s(6037),r=(a.Schema.Types.ObjectId,new a.Schema({name:{type:String,default:""},profilePic:{fileName:{type:String,default:""},filePath:{type:String,default:""}},description:{type:String,default:""}},{timestamps:!0}));e.exports=a.model("Teacher",r)},1935:(e,t,s)=>{const a=s(6037),r=(a.Schema.Types.ObjectId,new a.Schema({userId:{type:String,unique:!0,default:""},name:{type:String,required:!0,trim:!0},profilePic:{type:String},gender:{type:String,enum:["MALE","FEMALE","OTHER","UNDEFINED"],default:"UNDEFINED"},Address:{address:{type:String,default:""},apartment:{type:String,default:""},city:{type:String,default:""},post_code:{type:String,default:""},state:{type:String,default:""}},email:{type:String,default:""},phone:{type:String,default:""},date_of_birth:{type:String,default:""},education:{type:String,default:""}},{timestamps:!0}));e.exports=a.model("User",r)},2508:(e,t,s)=>{const a=s(7252).Router(),{createAdmin:r,adminLogin:i,getOneDayBookings:n,getOneWeekBookings:d,getOneMonthBookings:u,getOneYearBookings:o,getAllBookingsOfUser:l}=s(6593),{Authentication:c,Authorization:m}=s(3526);a.post("/api/v1/createSuperAdmin",r),a.post("/api/v1/loginSuperAdmin",i),a.get("/api/v1/getOneDayBookings/:adminId/:sessionToken/:date?",n),a.get("/api/v1/getOneWeekBookings/:adminId/:sessionToken/:startDate?/:endDate?",d),a.get("/api/v1/getOneMonthBookings/:adminId/:sessionToken/:month/:year",u),a.get("/api/v1/getOneYearBookings/:adminId/:sessionToken/:year",o),a.get("/api/v1/getUserAllBookings/:adminId/:sessionToken/:userId",l),e.exports=a},364:(e,t,s)=>{const a=s(7252).Router(),{createBooking:r,getSpecificBooking:i,getUserAllBookings:n,getAllBookings:d,getAllSlotsOfADate:u,updateBookingStatus:o}=s(1681);a.post("/api/v1/createBooking/:userId",r),a.get("/api/v1/getSpecificBooking/:bookingId",i),a.get("/api/v1/getUserAllBookings/:userId",n),a.get("/api/v1/getAllBookings/:key",d),a.get("/api/v1/getAllSlots/:date",u),a.put("/api/v1/updateBookingStatus/:bookingId",o),e.exports=a},2683:(e,t,s)=>{const a=s(7252).Router(),{addCategory:r,getCategoryById:i,getProductByKeywords:n,getAllCategories:d,updateCategory:u,deleteCategory:o}=s(452);a.post("/api/v1/addCategory/:key",r),a.post("/api/v1/viewService/:categoryId",i),a.post("/api/v1/allProductSearchByKeywords",n),a.get("/api/v1/getAllCategories/:key",d),a.put("/api/v1/updateCategory/:key/:categoryId",u),a.delete("/api/v1/deleteCategory/:key/:categoryId",o),e.exports=a},6826:(e,t,s)=>{const a=s(7252).Router(),{addCourse:r,getAllCourses:i,updateCourse:n,deleteCourse:d,getCourseById:u}=s(9957);a.post("/api/v1/addCourse/:key",r),a.get("/api/v1/getCourse/:key/:courseId",u),a.get("/api/v1/getAllCourses/:key",i),a.put("/api/v1/updateCourse/:key/:courseId",n),a.delete("/api/v1/deleteCourse/:key/:courseId",d),e.exports=a},6051:(e,t,s)=>{const a=s(7252).Router(),{getDashboard:r,updateBannerImages:i,deleteBannerImage:n}=s(9506);a.get("/api/v1/getDashboard/:userId?",r),a.put("/api/v1/addOrUpdateBanner/:key",i),a.delete("/api/v1/deleteBanner/:imageId/:key",n),e.exports=a},127:(e,t,s)=>{const a=s(7252).Router(),{addProduct:r,getProduct:i,updateProduct:n,deleteProduct:d,getAllProducts:u}=s(7001);a.post("/api/v1/addProduct/:key",r),a.get("/api/v1/getProduct/:productId/:key",i),a.get("/api/v1/getAllProducts/:key",u),a.put("/api/v1/updateProduct/:productId/:key",n),a.delete("/api/v1/deleteProduct/:productId/:key",d),e.exports=a},468:(e,t,s)=>{const a=s(7252).Router(),{purchaseCourse:r,getPurchasedCourse:i,getAllPurchasedCourses:n,updatePurchasedCourseDetails:d,deletePurchaseDetails:u}=s(3974);a.post("/api/v1/addPurchaseDetails",r),a.get("/api/v1/getPurchasedDetails/:purchaseId",i),a.get("/api/v1/getAllPurchasedDetails",n),a.put("/api/v1/updatePurchasedDetails/:purchaseId",d),a.delete("/api/v1/deletePurchaseDetails/:purchaseId",u),e.exports=a},8738:(e,t,s)=>{const a=s(7252).Router(),{createClassSchedule:r,getAllClassSchedule:i,getSchedule:n,updateSchedule:d,deleteSchedule:u}=s(8295);a.post("/api/v1/createSchedule",r),a.get("/api/v1/getSchedule/:courseId",n),a.get("/api/v1/getAllClassSchedule",i),a.put("/api/v1/updateSchedule/:courseId",d),a.delete("/api/v1/deletSchedule/:courseId",u),e.exports=a},8822:(e,t,s)=>{const a=s(7252).Router(),{addSuperDeal:r,getSuperdealById:i,getAllSuperdeals:n,updateSuperdeal:d,deleteSuperdeal:u}=s(9903);a.post("/api/v1/addSuperdeal",r),a.get("/api/v1/getSuperdealById/:superdealId",i),a.get("/api/v1/getAllSuperdeals",n),a.put("/api/v1/updateSuperdeal/:superdealId",d),a.delete("/api/v1/deleteSuperdeal/:superdealId",u),e.exports=a},1901:(e,t,s)=>{const a=s(7252).Router(),{addTeacher:r,getAllTeachers:i,getTeacherById:n,updateTeacher:d,deleteTeacher:u}=s(5196);a.post("/api/v1/addTeacher/:key",r),a.get("/api/v1/getTeacher/:teacherId",n),a.get("/api/v1/getAllTeachers/:key",i),a.put("/api/v1/updateTeacher/:teacherId",d),a.delete("/api/v1/deletTeacher/:teacherId",u),e.exports=a},9768:(e,t,s)=>{const a=s(7252).Router(),{authenticateUser:r,updateUser:i,getAllUsers:n,getUserById:d,deleteUser:u}=s(1579);a.post("/api/v1/authenticateUser",r),a.get("/api/v1/getUser/:userId/:key",d),a.get("/api/v1/users/:key",n),a.post("/api/v1/updateUser/:userId",i),a.delete("/api/v1/deleteUser/:userId",u),a.get("/api/v1/getAllUsers",n),e.exports=a},7048:(e,t,s)=>{const a=s(3797),{StatusCodes:r}=s(7138);e.exports={errorHandler:function(e,t,s,i){return e instanceof a?s.status(e.statusCode).json({success:!1,message:e.message,err:e.details,data:{}}):s.status(r.INTERNAL_SERVER_ERROR).json({success:!1,message:"Something went wrong",err:e,data:{}})}}},8093:(e,t,s)=>{const a=s(857);e.exports={getCurrentIPAddress:()=>{let e=a.networkInterfaces();return Object.values(e).flat().filter((e=>"IPv4"===e.family&&!e.internal)).map((e=>e.address))[0]},generateRandomAlphaNumericID:function(e){let t="";for(let s=0;s<e;s++)t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"[Math.floor(62*Math.random())];return t}}},5486:e=>{"use strict";e.exports=require("bcrypt")},3268:e=>{"use strict";e.exports=require("body-parser")},7174:e=>{"use strict";e.exports=require("compression")},8577:e=>{"use strict";e.exports=require("cors")},818:e=>{"use strict";e.exports=require("dotenv")},7252:e=>{"use strict";e.exports=require("express")},6376:e=>{"use strict";e.exports=require("express-fileupload")},2239:e=>{"use strict";e.exports=require("express-mongo-sanitize")},2525:e=>{"use strict";e.exports=require("helmet")},8900:e=>{"use strict";e.exports=require("hpp")},7138:e=>{"use strict";e.exports=require("http-status-codes")},829:e=>{"use strict";e.exports=require("jsonwebtoken")},6037:e=>{"use strict";e.exports=require("mongoose")},3903:e=>{"use strict";e.exports=require("uuid")},5124:e=>{"use strict";e.exports=require("winston")},8639:e=>{"use strict";e.exports=require("winston-mongodb")},9896:e=>{"use strict";e.exports=require("fs")},857:e=>{"use strict";e.exports=require("os")},6928:e=>{"use strict";e.exports=require("path")}},t={};function s(a){var r=t[a];if(void 0!==r)return r.exports;var i=t[a]={exports:{}};return e[a](i,i.exports,s),i.exports}const a=s(7252),r=s(3268),i=s(6376),n=s(8577),d=s(2525),u=s(7174),o=s(2239),l=s(8900),{port:c}=s(669),{connectToDatabase:m}=s(6865),{errorHandler:g}=s(7048),p=a();p.use(d()),p.use(n()),p.use(u()),p.use(o()),p.use(l()),p.use(a.json({limit:"50mb"})),p.use(a.urlencoded({extended:!0,limit:"50mb"})),p.use(r.json({limit:"50mb"})),p.use(r.text()),p.use(i()),p.use(n());const y=s(2508),f=s(6826),I=s(9768),h=s(127),S=s(2683),_=s(364),k=s(6051),b=s(8822),v=s(468),w=s(8738),A=s(1901);p.use(d.contentSecurityPolicy({directives:{defaultSrc:["'self'"],scriptSrc:["'self'","'unsafe-inline'"],objectSrc:["'none'"],upgradeInsecureRequests:[]}})),p.use(d.hsts({maxAge:31536e3,includeSubDomains:!0,preload:!0})),p.use("/userImages",a.static(__dirname+"/userImages")),p.use("/productImages",a.static(__dirname+"/productImages")),p.use("/categoryImages",a.static(__dirname+"/categoryImages/")),p.use("/superdealImages",a.static(__dirname+"/superdealImages")),p.use("/bannerImages",a.static(__dirname+"/bannerImages")),p.use("/courseImages",a.static(__dirname+"/courseImages")),p.use("/class_pdf",a.static(__dirname+"/class_pdf")),p.use("/",y),p.use("/",f),p.use("/",I),p.use("/",h),p.use("/",S),p.use("/",_),p.use("/",k),p.use("/",b),p.use("/",v),p.use("/",w),p.use("/",A),p.get("/",((e,t)=>{t.send("<h1>Coaching App is Up and Running</h1>")})),p.use(g);const N=p.listen(c,(async()=>{console.log("App is running on port",c),await m}));process.on("unhandledRejection",((e,t)=>{console.error("Unhandled Rejection at:",t,"reason:",e),N.close((()=>{process.exit(1)}))})),process.on("uncaughtException",(e=>{console.error("Uncaught Exception thrown:",e),N.close((()=>{process.exit(1)}))})),process.on("SIGTERM",(()=>{console.log("SIGTERM signal received: closing HTTP server"),N.close((()=>{console.log("HTTP server closed"),process.exit(0)}))})),process.on("SIGINT",(()=>{console.log("SIGINT signal received: closing HTTP server"),N.close((()=>{console.log("HTTP server closed"),process.exit(0)}))}))})();
//# sourceMappingURL=index.js.map